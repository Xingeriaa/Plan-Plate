<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PlannPlate - Organic Ingredients</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="css/styles.css" rel="stylesheet">
    <link href="css/animations.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>

<header class="bg-light py-3">
    <div class="container">
        <div class="d-flex justify-content-between align-items-center">
            <div class="d-flex align-items-center" style="cursor: pointer;" onclick="window.location.href='/'">
                <img src="images/logo.png" alt="PlannPlate Logo" class="me-3" style="width: 60px;">
                <h1>PlannPlate</h1>
            </div>

            <div class="flex-grow-1 mx-3 position-relative">
                <input type="text" class="form-control" id="searchInput" placeholder="What are you looking for?">
                <div id="searchResults" class="search-results d-none position-absolute w-100 mt-1"></div>
            </div>

            <div class="d-flex align-items-center">
                <a href="#" class="btn btn-outline-primary me-3" id="accountBtn">My Account</a>
                <a href="#" class="btn btn-outline-primary position-relative" id="cartBtn">
                    Cart
                    <span class="badge bg-danger position-absolute top-0 start-100 translate-middle p-1 badge-circle" id="cartCount">0</span>
                </a>
            </div>
        </div>

<div class="account-sidebar" id="accountSidebar">
    <div class="account-sidebar-content">
        <div class="account-header">
            <h2>MY ACCOUNT</h2>
            <button class="close-btn" id="closeSidebarBtn">&times;</button>
        </div>
        <div class="account-body">
            <a href="/login" class="btn btn-primary w-100 mb-3">LOGIN</a>
            <a href="#" class="return-link" id="returnToStoreBtn">RETURN TO STORE</a>
        </div>
    </div>
    <div class="sidebar-overlay" id="accountSidebarOverlay"></div>
</div>

<div class="cart-sidebar" id="cartSidebar">
    <div class="cart-sidebar-content">
        <div class="cart-header">
            <h2>VIEW CART</h2>
            <button class="close-btn" id="closeCartBtn">&times;</button>
        </div>
        <div class="cart-body" id="cartItems">
        </div>
        <div class="cart-footer">
            <div class="cart-summary">
                <div class="d-flex justify-content-between mb-2">
                    <span>Subtotal</span>
                    <span id="cartSubtotal">₫0</span>
                </div>
                <div class="d-flex justify-content-between mb-2">
                    <span>Tax <small>(calculated in checkout)</small></span>
                    <span>-</span>
                </div>
                <div class="d-flex justify-content-between mb-3">
                    <span>Shipping</span>
                    <span>-</span>
                </div>
                <div class="shipping-note mb-3">
                    <small>Taxes, shipping and promotions calculated in checkout.</small>
                </div>
                <div class="mb-3">
                    <label for="cartNotes" class="form-label">Delivery note or comments (Optional)</label>
                    <textarea class="form-control" id="cartNotes" rows="3"></textarea>
                </div>
                <div class="d-flex justify-content-between mb-3">
                    <span><strong>Estimated Total</strong></span>
                    <span id="cartTotal"><strong>₫0</strong></span>
                </div>
                <button class="btn btn-primary" id="checkoutBtn">CHECKOUT</button>
            </div>
        </div>
    </div>
    <div class="sidebar-overlay" id="cartSidebarOverlay"></div>
</div>
        <nav class="navbar navbar-expand-lg navbar-light">
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav mx-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="about.html">About Us</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="faq.html">FAQ</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/product-listing.html">All Products</a>
                    </li>
                    <!-- Update the bestsellers link in the navigation -->
                    <li class="nav-item">
                        <a class="nav-link" href="/bestsellers">Bestsellers</a>
                    </li>
                </ul>
            </div>
        </nav>
    </div>
</header>

<section class="carousel-section mt-4">
    <div id="carouselExampleIndicators" class="carousel slide" data-bs-ride="carousel">
        <div class="carousel-indicators">
            <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
            <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="1" aria-label="Slide 2"></button>
            <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="2" aria-label="Slide 3"></button>
            <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="3" aria-label="Slide 4"></button>
        </div>
        <div class="carousel-inner">
            <div class="carousel-item active">
                <img src="https://www.omfoods.com/cdn/shop/files/Banner_NEW.jpg?v=1681412890" class="d-block w-100" alt="Organic Foods">
            </div>
            <div class="carousel-item">
                <img src="https://www.omfoods.com/cdn/shop/files/OMFOODS_ORGANIC.jpg?v=1681412890" class="d-block w-100" alt="Organic Foods">
            </div>
            <div class="carousel-item">
                <img src="https://www.omfoods.com/cdn/shop/files/SALE_PRODUCTS_OM_FOODS.jpg?v=1681412890" class="d-block w-100" alt="Organic Foods">
            </div>
            <div class="carousel-item">
                <img src="https://www.omfoods.com/cdn/shop/files/OMFOODS_ORGANIC_INGREDIENTS.jpg?v=1681412891" class="d-block w-100 " alt="Organic Foods">
            </div>
        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Next</span>
        </button>
    </div>
</section>

<div class="section-divider"></div>

<!-- Replace the static product cards with this dynamic version -->
<!-- After the carousel section and before the products section -->
<section class="banner-section mt-5 fade-in">
    <div class="container">
        <div class="row">
            <div class="col-12">
                <div class="banner p-4 rounded" style="background-color: #f8f9fa; border-left: 5px solid #28a745;">
                    <div class="row align-items-center">
                        <div class="col-md-8">
                            <h3 class="mb-3">Fresh Organic Ingredients Delivered to Your Door</h3>
                            <p class="mb-3">Discover our premium selection of organic, sustainably sourced ingredients. From farm to table, we ensure quality in every product.</p>
                            <ul class="list-unstyled mb-0">
                                <li class="mb-2"><i class="bi bi-check-circle-fill text-success me-2"></i> 100% Organic Certified</li>
                                <li class="mb-2"><i class="bi bi-check-circle-fill text-success me-2"></i> Free Shipping on Orders Over $50</li>
                                <li><i class="bi bi-check-circle-fill text-success me-2"></i> Sustainable Packaging</li>
                            </ul>
                        </div>
                        <div class="col-md-4 text-center text-md-end mt-3 mt-md-0">
                            <a href="/product-listing.html" class="btn btn-success btn-lg">Shop Now</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Add featured categories section before the main categories -->
<section class="featured-section mt-5 slide-in">
    <div class="container">
        <h2 class="text-center mb-4" style="font-weight: bold;">Featured Categories</h2>
        <div class="row g-4">
            <div class="col-md-4">
                <div class="card h-100 border-0 shadow-sm">
                    <span class="organic-badge">100% Organic</span>
                    <div class="card-body text-center">
                        <i class="bi bi-flower1 text-success" style="font-size: 3rem;"></i>
                        <h4 class="mt-3">Organic Herbs</h4>
                        <p class="text-muted">Fresh and dried herbs to enhance your cooking</p>
                        <a href="/product-listing.html?category=1" class="btn btn-outline-success">Explore</a>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card h-100 border-0 shadow-sm">
                    <span class="organic-badge">100% Organic</span>
                    <div class="card-body text-center">
                        <i class="bi bi-droplet-fill text-success" style="font-size: 3rem;"></i>
                        <h4 class="mt-3">Essential Oils</h4>
                        <p class="text-muted">Pure, natural oils for cooking and aromatherapy</p>
                        <a href="/product-listing.html?category=2" class="btn btn-outline-success">Explore</a>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card h-100 border-0 shadow-sm">
                    <span class="organic-badge">100% Organic</span>
                    <div class="card-body text-center">
                        <i class="bi bi-basket2-fill text-success" style="font-size: 3rem;"></i>
                        <h4 class="mt-3">Organic Grains</h4>
                        <p class="text-muted">Wholesome grains for nutritious meals</p>
                        <a href="/product-listing.html?category=3" class="btn btn-outline-success">Explore</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<div class="section-divider"></div>

<!-- Update the products section title to be more descriptive -->
<section class="products-section mt-5 fade-in">
    <div class="container">
        <h2 class="text-center" style="font-weight: bold;">Browse All Categories</h2>
        <p class="text-center text-muted mb-4">Explore our wide range of organic ingredients for your healthy lifestyle</p>
        <div class="row" id="categoriesContainer">
            <!-- Categories will be loaded dynamically here -->
        </div>
    </div>
</section>

<div class="section-divider"></div>

<!-- Add testimonials section before the footer -->
<section class="testimonials-section mt-5 py-5 slide-in" style="background-color: #f8f9fa;">
    <div class="container">
        <h2 class="text-center mb-4" style="font-weight: bold;">What Our Customers Say</h2>
        <div class="row">
            <div class="col-md-4 mb-4">
                <div class="card h-100 border-0 shadow-sm">
                    <div class="card-body">
                        <div class="d-flex mb-3">
                            <i class="bi bi-star-fill text-warning me-1"></i>
                            <i class="bi bi-star-fill text-warning me-1"></i>
                            <i class="bi bi-star-fill text-warning me-1"></i>
                            <i class="bi bi-star-fill text-warning me-1"></i>
                            <i class="bi bi-star-fill text-warning"></i>
                        </div>
                        <p class="card-text">"The quality of ingredients from PlannPlate is exceptional. My family loves the organic flour for our weekend baking sessions!"</p>
                        <div class="d-flex align-items-center mt-3">
                            <div class="rounded-circle bg-success text-white d-flex align-items-center justify-content-center" style="width: 40px; height: 40px;">JD</div>
                            <div class="ms-3">
                                <h6 class="mb-0">Jane Doe</h6>
                                <small class="text-muted">Loyal Customer</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-4 mb-4">
                <div class="card h-100 border-0 shadow-sm">
                    <div class="card-body">
                        <div class="d-flex mb-3">
                            <i class="bi bi-star-fill text-warning me-1"></i>
                            <i class="bi bi-star-fill text-warning me-1"></i>
                            <i class="bi bi-star-fill text-warning me-1"></i>
                            <i class="bi bi-star-fill text-warning me-1"></i>
                            <i class="bi bi-star-fill text-warning"></i>
                        </div>
                        <p class="card-text">"Fast delivery and sustainable packaging. I appreciate a company that cares about the environment as much as the quality of their products."</p>
                        <div class="d-flex align-items-center mt-3">
                            <div class="rounded-circle bg-success text-white d-flex align-items-center justify-content-center" style="width: 40px; height: 40px;">JS</div>
                            <div class="ms-3">
                                <h6 class="mb-0">John Smith</h6>
                                <small class="text-muted">New Customer</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-4 mb-4">
                <div class="card h-100 border-0 shadow-sm">
                    <div class="card-body">
                        <div class="d-flex mb-3">
                            <i class="bi bi-star-fill text-warning me-1"></i>
                            <i class="bi bi-star-fill text-warning me-1"></i>
                            <i class="bi bi-star-fill text-warning me-1"></i>
                            <i class="bi bi-star-fill text-warning me-1"></i>
                            <i class="bi bi-star-half text-warning"></i>
                        </div>
                        <p class="card-text">"The variety of organic spices is impressive. I've completely transformed my cooking since discovering PlannPlate's selection."</p>
                        <div class="d-flex align-items-center mt-3">
                            <div class="rounded-circle bg-success text-white d-flex align-items-center justify-content-center" style="width: 40px; height: 40px;">AL</div>
                            <div class="ms-3">
                                <h6 class="mb-0">Amy Lee</h6>
                                <small class="text-muted">Food Blogger</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const accountBtn = document.getElementById('accountBtn');
        const accountSidebar = document.getElementById('accountSidebar');
        const closeSidebarBtn = document.getElementById('closeSidebarBtn');
        const accountSidebarOverlay = document.getElementById('accountSidebarOverlay');
        const returnToStoreBtn = document.getElementById('returnToStoreBtn');
        
        const cartBtn = document.getElementById('cartBtn');
        const cartSidebar = document.getElementById('cartSidebar');
        const closeCartBtn = document.getElementById('closeCartBtn');
        const cartSidebarOverlay = document.getElementById('cartSidebarOverlay');
        const cartItemsContainer = document.getElementById('cartItems');
        const cartSubtotal = document.getElementById('cartSubtotal');
        const cartTotal = document.getElementById('cartTotal');
        const checkoutBtn = document.getElementById('checkoutBtn');
        const cartCount = document.getElementById('cartCount');
        
        let cartItems = JSON.parse(localStorage.getItem('cartItems')) || [];
        
        function openSidebar() {
            accountSidebar.classList.add('active');
            accountSidebarOverlay.style.display = 'block';
            document.body.style.overflow = 'hidden'; 
        }
        
        function closeSidebar() {
            accountSidebar.classList.remove('active');
            accountSidebarOverlay.style.display = 'none';
            document.body.style.overflow = ''; 
        }
        
        function openCartSidebar() {
            cartSidebar.classList.add('active');
            cartSidebarOverlay.style.display = 'block';
            document.body.style.overflow = 'hidden'; 
            renderCartItems();
        }
        
        function closeCartSidebar() {
            cartSidebar.classList.remove('active');
            cartSidebarOverlay.style.display = 'none';
            document.body.style.overflow = '';
        }
        
        function checkAuthStatus() {
            return fetch('/auth/check', {
                method: 'GET',
                credentials: 'same-origin',
                headers: {
                    'Accept': 'application/json'
                }
            })
            .then(response => response.json())
            .catch(error => {
                console.error('Authentication check failed:', error);
                return { authenticated: false };
            });
        }
        
        function renderCartItems() {
            cartItemsContainer.innerHTML = '';
            
            if (cartItems.length === 0) {
                cartItemsContainer.innerHTML = '<p class="text-center my-5">Your cart is empty</p>';
                cartSubtotal.textContent = '$0.00';
                cartTotal.textContent = '$0.00';
                return;
            }
            
            let subtotal = 0;
            
            cartItems.forEach((item, index) => {
                const price = parseFloat(item.price.replace('$', ''));
                const itemTotal = price * item.quantity;
                subtotal += itemTotal;
                
                const cartItemElement = document.createElement('div');
                cartItemElement.className = 'cart-item';
                cartItemElement.innerHTML = `
                    <div class="cart-item-image">
                        <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="currentColor" class="bi bi-box" viewBox="0 0 16 16">
                            <path d="M8.186 1.113a.5.5 0 0 0-.372 0L1.846 3.5 8 5.961 14.154 3.5 8.186 1.113zM15 4.239l-6.5 2.6v7.922l6.5-2.6V4.24zM7.5 14.762V6.838L1 4.239v7.923l6.5 2.6zM7.443.184a1.5 1.5 0 0 1 1.114 0l7.129 2.852A.5.5 0 0 1 16 3.5v8.662a1 1 0 0 1-.629.928l-7.185 2.874a.5.5 0 0 1-.372 0L.63 13.09a1 1 0 0 1-.63-.928V3.5a.5.5 0 0 1 .314-.464L7.443.184z"/>
                        </svg>
                    </div>
                    <div class="cart-item-details">
                        <div class="cart-item-name">${item.name}</div>
                        <div class="cart-item-type">Type</div>
                        <div class="cart-item-total">Total: ${item.price}</div>
                        <div class="cart-item-quantity">
                            <button class="quantity-btn minus-btn" data-index="${index}">-</button>
                            <input type="text" class="quantity-input" value="${item.quantity}" readonly>
                            <button class="quantity-btn plus-btn" data-index="${index}">+</button>
                        </div>
                        <a href="#" class="cart-item-remove" data-index="${index}">Remove</a>
                    </div>
                `;
                
                cartItemsContainer.appendChild(cartItemElement);
            });
            
            cartSubtotal.textContent = '$' + subtotal.toFixed(2);
            cartTotal.textContent = '$' + subtotal.toFixed(2);

            document.querySelectorAll('.minus-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const index = parseInt(this.getAttribute('data-index'));
                    if (cartItems[index].quantity > 1) {
                        cartItems[index].quantity -= 1;
                        updateCart();
                    }
                });
            });
            
            document.querySelectorAll('.plus-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const index = parseInt(this.getAttribute('data-index'));
                    cartItems[index].quantity += 1;
                    updateCart();
                });
            });
            
            document.querySelectorAll('.cart-item-remove').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const index = parseInt(this.getAttribute('data-index'));
                    cartItems.splice(index, 1);
                    updateCart();
                });
            });
        }
        
        function updateCart() {
            localStorage.setItem('cartItems', JSON.stringify(cartItems));
            updateCartCount();
            renderCartItems();
        }
        
        function updateCartCount() {
            const totalItems = cartItems.reduce((total, item) => total + item.quantity, 0);
            cartCount.textContent = totalItems;
        }
        
        accountBtn.addEventListener('click', function(e) {
            e.preventDefault();
            
            checkAuthStatus().then(data => {
                if (data.authenticated) {
                    window.location.href = '/profile';
                } else {
                    openSidebar();
                }
            });
        });
        
        closeSidebarBtn.addEventListener('click', closeSidebar);
        accountSidebarOverlay.addEventListener('click', closeSidebar);
        returnToStoreBtn.addEventListener('click', function(e) {
            e.preventDefault();
            closeSidebar();
        });
        
        cartBtn.addEventListener('click', function(e) {
            e.preventDefault();
            openCartSidebar();
        });
        
        closeCartBtn.addEventListener('click', closeCartSidebar);
        cartSidebarOverlay.addEventListener('click', closeCartSidebar);
        
        checkoutBtn.addEventListener('click', function() {
            if (cartItems.length === 0) {
                alert('Your cart is empty');
            } else {
                alert('Proceeding to checkout...');
            }
        });
        
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                if (accountSidebar.classList.contains('active')) {
                    closeSidebar();
                }
                if (cartSidebar.classList.contains('active')) {
                    closeCartSidebar();
                }
            }
        });
        
        const searchInput = document.getElementById('searchInput');
        const searchResults = document.getElementById('searchResults');
        
        // Replace the existing search input event listener with this improved version
        let searchTimeout;
        searchInput.addEventListener('input', function() {
            const query = this.value.trim();
            
            // Clear any existing timeout
            clearTimeout(searchTimeout);
            
            // Hide results if query is too short
            if (query.length < 3) {
                searchResults.classList.add('d-none');
                return;
            }
            
            // Show loading indicator
            searchResults.innerHTML = '<div class="text-center py-2"><div class="spinner-border spinner-border-sm text-primary" role="status"></div> Searching...</div>';
            searchResults.classList.remove('d-none');
            
            // Set a timeout to delay the search request (debouncing)
            searchTimeout = setTimeout(() => {
                searchProducts(query);
            }, 300); // Wait 300ms after user stops typing
        });
        
        function searchProducts(query) {
            // Cache for search results
            if (!window.searchCache) {
                window.searchCache = {};
            }
            
            // Check if we have cached results for this query
            if (window.searchCache[query]) {
                displaySearchResults(window.searchCache[query]);
                return;
            }
            
            // Fetch products from API based on search query
            fetch(`/api/search?q=${encodeURIComponent(query)}`)
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Search request failed');
                    }
                    return response.json();
                })
                .then(products => {
                    // Cache the results
                    window.searchCache[query] = products;
                    displaySearchResults(products);
                })
                .catch(error => {
                    console.error('Search error:', error);
                    searchResults.innerHTML = '<div class="no-results p-3">Error searching products. Please try again.</div>';
                });
        }
        
        function displaySearchResults(products) {
            searchResults.innerHTML = '';
            
            if (products.length === 0) {
                searchResults.innerHTML = '<div class="no-results p-3">No products found</div>';
                return;
            }
            
            // Display search results
            products.forEach(product => {
                const resultItem = document.createElement('div');
                resultItem.className = 'search-result-item';
                
                // Format price with thousand separator
                const formattedPrice = new Intl.NumberFormat('vi-VN').format(product.Gia);
                
                resultItem.innerHTML = `
                    <div class="d-flex align-items-center">
                        <div class="search-result-img">
                            <img src="${product.HinhAnhSanPham || 'images/placeholder.png'}" alt="${product.TenSanPham}" onerror="this.src='images/placeholder.png'">
                        </div>
                        <div class="ms-3">
                            <div class="product-name">${product.TenSanPham}</div>
                            <div class="product-price">${formattedPrice}₫</div>
                        </div>
                    </div>
                `;
                
                resultItem.addEventListener('click', function() {
                    window.location.href = `/product/${product.IDSanPham}`;
                });
                
                searchResults.appendChild(resultItem);
            });
        }
        
        document.addEventListener('click', function(e) {
            if (!searchInput.contains(e.target) && !searchResults.contains(e.target)) {
                searchResults.classList.add('d-none');
            }
        });
        
        updateCartCount();
        
        // Add this function to fetch and display categories
        // Update the loadCategories function to fetch product counts
        function loadCategories() {
            fetch('/api/categories')
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.json();
                })
                .then(categories => {
                    const categoriesContainer = document.getElementById('categoriesContainer');
                    categoriesContainer.innerHTML = '';
                    
                    if (categories.length === 0) {
                        categoriesContainer.innerHTML = '<div class="col-12 text-center"><p>No categories found</p></div>';
                        return;
                    }
                    
                    // Create an array of promises for fetching product counts
                    const productCountPromises = categories.map(category => 
                        fetch(`/api/products/${category.IDDanhMuc}`)
                            .then(response => response.json())
                            .then(products => ({
                                category: category,
                                productCount: products.length
                            }))
                            .catch(error => ({
                                category: category,
                                productCount: 0
                            }))
                    );
                    
                    // Wait for all product count requests to complete
                    Promise.all(productCountPromises)
                        .then(categoriesWithCounts => {
                            categoriesWithCounts.forEach(({ category, productCount }) => {
                                const categoryCol = document.createElement('div');
                                categoryCol.className = 'col-md-4 col-lg-3 mb-4';
                                
                                categoryCol.innerHTML = `
                                    <div class="card h-100" data-category-id="${category.IDDanhMuc}" style="cursor: pointer;">
                                        <img src="${category.HinhAnhSanPham}" class="card-img-top" alt="${category.TenDanhMuc}">
                                        <div class="card-body">
                                            <h5 class="card-title">${category.TenDanhMuc.toUpperCase()}</h5>
                                            <p class="card-text">${productCount} PRODUCTS</p>
                                        </div>
                                    </div>
                                `;
                                
                                categoriesContainer.appendChild(categoryCol);
                            });
                            
                            // Re-attach event listeners to the new cards
                            const productCards = document.querySelectorAll('.card');
                            productCards.forEach(card => {
                                card.addEventListener('click', function() {
                                    const categoryId = this.getAttribute('data-category-id');
                                    const categoryName = this.querySelector('.card-title').textContent;
                                    
                                    // Redirect to product listing page with category ID
                                    window.location.href = `/product-listing.html?category=${categoryId}`;
                                });
                            });
                        });
                })
                .catch(error => {
                    console.error('Error loading categories:', error);
                    document.getElementById('categoriesContainer').innerHTML = 
                        '<div class="col-12 text-center"><p>Failed to load categories. Please try again later.</p></div>';
                });
        }
        
        // Call this function in your DOMContentLoaded event
        loadCategories();
    });
</script>

<script src="js/sidebar.js"></script>

<!-- Add this footer section at the bottom of your page, just before the closing </body> tag -->
<footer class="bg-light mt-5 py-4">
    <div class="container">
        <div class="row">
            <div class="col-md-4 mb-3">
                <h5>PlannPlate</h5>
                <p>Your source for premium organic ingredients and healthy food products.</p>
            </div>
            <div class="col-md-2 mb-3">
                <h5>Shop</h5>
                <ul class="list-unstyled">
                    <li><a href="#" class="text-decoration-none">All Products</a></li>
                    <li><a href="#" class="text-decoration-none">Bestsellers</a></li>
                    <li><a href="#" class="text-decoration-none">New Arrivals</a></li>
                    <li><a href="#" class="text-decoration-none">Sale</a></li>
                </ul>
            </div>
            <div class="col-md-2 mb-3">
                <h5>About</h5>
                <ul class="list-unstyled">
                    <li><a href="about.html" class="text-decoration-none">Our Story</a></li>
                    <li><a href="#" class="text-decoration-none">Blog</a></li>
                    <li><a href="faq.html" class="text-decoration-none">FAQ</a></li>
                    <li><a href="#" class="text-decoration-none">Contact</a></li>
                </ul>
            </div>
            <div class="col-md-4 mb-3">
                <h5>Stay Connected</h5>
                <p>Subscribe to our newsletter for updates and promotions.</p>
                <div class="input-group mb-3">
                    <input type="email" class="form-control" placeholder="Your email" aria-label="Your email">
                    <button class="btn btn-primary" type="button">Subscribe</button>
                </div>
                <div class="social-icons">
                    <a href="#" class="me-2"><i class="bi bi-facebook"></i></a>
                    <a href="#" class="me-2"><i class="bi bi-instagram"></i></a>
                    <a href="#" class="me-2"><i class="bi bi-twitter"></i></a>
                    <a href="#" class="me-2"><i class="bi bi-pinterest"></i></a>
                </div>
            </div>
        </div>
        <hr>
        <div class="row">
            <div class="col-md-6">
                <p class="mb-0">&copy; 2023 PlannPlate. All rights reserved.</p>
            </div>
            <div class="col-md-6 text-md-end">
                <a href="#" class="text-decoration-none me-3">Privacy Policy</a>
                <a href="#" class="text-decoration-none me-3">Terms of Service</a>
                <a href="#" class="text-decoration-none">Shipping Policy</a>
            </div>
        </div>
    </div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.min.js"></script>
